# Highfidelity Mockup Demo Scenarios

## High-fid demo scenario (Draft)

- I am an accidental DBA
- I was asked to create a meaningful recovery plan
- That can gaurantee 15min RPO - recovery time objective
- It should run as a scheduled task
- and I can test if the plan and backups are all correctly fine by running a fire drill.

Terms:
    Recovery Plan = Backup plan + Restore plan

### Connect
- Using OE Server Groups and connection, make a conneciton
- On MANAGE (server), see recovery insight for all databases.
    - Find out our demo db does not have backup configured.
- On the recovery insight detail fly out, see backup status of all databases
    - indicate our database does not have backup ready.
    start [ recovery plan builder ] task on the database from the fly out

### Backup - Building recovery plan

- Using carbon on a database

I CAN specify the RPO requirement which is 15 min.

Carbon produces backup jobs for intelligently built backup scripts.
    - Create full backup with 24 hour schedule
    - Create diff backup with 6 hour schedule
    - craete log backup with 15min schedule

I CAN review the backup plan generated by Carbon, revise and save scripts in a file for later execution
or run immediately to create scheduler jobs.

#### UX flow

Open Recovery Plan Builder task

- What is the required RPO? [  15  ]min
- Click [ Generate Plan ]
- Show Generated Plan Summary
    - [x] Full Backup every [24] hours starting at [12:00 AM]
    - [x] Diff Backup every [6] hours starting at [6:00 am]
    - [x] Log backup every [15] mins starting at [6:15 am]

- [ save a job script] [ run ]

### Scheduling - creating scheduler jobs and monitoring

I CAN get at-a-glance view of my scheduled job insight on MANAGE Dashboard.
    - Total jobs in the past 24 hours
    - number of successful job
    - number of jobs in progress
    - number of failed job
    - [ Click ] to open Job details

I CAN open scheduler (Agent) monitoring page and see the list of successful / failed backup jobs.


### Smart recovery

Connect to server using OE. Navigage to our database.

Start [ Restore ]

I CAN run a fire-drill of incident recovery scenario of my database.

#### UX flow

Open Restore task on a database

- Restore dialog provides restore plan based the currently existing backup.

I CAN specify restore point in time or go with the smart default.
    - Point in time
    - Latest backup (default)
    - Latest transaction including transactions occurred after the last backup.

- Restore dialog displays the generated restore plan.

    - [x] backup tail-log to [backup-2017-06-31.bak]
    - [x] Restore the latest full backup
    - [x] Restore diff backups
    - [x] Restore log backups
    - [x] Restore the tail-log backup

- enter [ DBname-recovered-2015-06-01 ] to simulate the restore in fire-drill scenario

I CAN review and revise the restore plan.

    - Key properties of restore plan
        - Restore yes / no [ ] checkbox
        - Name of backupset
        - Component
        - Type
        - Position
        - Size

        - Advanced
            - First LSN
            - Last LSN
            - Checkpoint LSN
            - Start and End date
            - User Name
            - Expiration

I CAN [save it as t-sql script] or [run] immediately.


--end-of-scenario--
#



## Migration of SQL Server database from Windows to Linux

Demonstrate the **migration of database** from Windows to Linux using core Carbon functionality and QDS insights.

1. Connect SQL Server 2008 R2 server running on Windows.
2. Browse and find AdventureWorks database on OE
3. Backup AdventureWorks.
4. Using the integrated commandline in Carbon, connect to Docker container running SQL Server 2017 Ubuntu.
5. docker cp the backup file to the docker continer.
6. Connect to SQL Server 2017 on Docker.
7. Restore AdventureWorks.
8. Open MANAGE page for AdventureWorks.
9. Show compatibility - 100
10. Run application workload and verify no regression using **QDS insights on MANAGE page**.
11. Open Database Property edit page - change the compatibility to 140.

## Recovery of database with corrupted data file

Demonstrate **recovery assurance insights** and super easy experience to recover from an incident like damaged file. (for PITR show accidental drop / truncation of table).

SQL Server 2017 running on Linux with 20 databases - mix of mission critical and non-mission critical.

1. Connect to SQL Server instance
2. Open Server MANAGE page.
3. MANAGE page shows an **at-a-glance view of recovery RPO and recovery readiness information** about the database.
4. Simulate diaster - go to interactive terminal in Carbon, docker /bin/bash in and delete database's mdf file to make it corrupted.
5. Back to Server MANAGE page.
6. Show the **database with state insight** - the damaged database should be in 'RECOVERY PENDING' with a bright red mark on the database.
7. On the database start Restore.
8. **Restore page starts with timeslider showing insight about available backup to restore**.
9. Crank the slider all the way to the right which will **include the latest backup as well as automatically generated tail-log backup**.
10. Specify a new database 'database-recovered'
11. **Recover in just a few clicks**.
12. Show the recovered database content in OE and SELECT TOP 1000 rows from a table.


